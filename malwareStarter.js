/** @param {NS} ns **/
export async function main(ns) {

      const HOST = ns.getHostname();

      if (HOST == 'home') {
            return 0;
      }
      else {
            //get ram for hack script
            var scriptRAM = ns.getScriptRam('malware.js', HOST);
            //get available server ram for targeted server
            var availableRAM = ns.getServerMaxRam(HOST) - ns.getServerUsedRam(HOST);
            //calculate threads for hack script on target server
            var threadNum = Math.floor(availableRAM / scriptRAM);

            if (availableRAM >= scriptRAM && threadNum >= 1) {
                  ns.spawn('malware.js', threadNum, threadNum);
            }
            else {
                  ns.toast(ns.getScriptName() + ' was unable to execute on ' + HOST, 'error');
            }
      }
}
